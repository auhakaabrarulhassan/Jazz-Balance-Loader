<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PakSim Balance Calculator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .sim-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .sim-btn:hover {
            transform: translateY(-2px);
        }
        .sim-btn.active {
            transform: scale(1.05);
        }

        /* Brand Gradients/Colors for Active States */
        .brand-jazz { --brand-color: #8B0000; --brand-bg: #ef4444; }
        .brand-zong { --brand-color: #87C440; --brand-bg: #84cc16; }
        .brand-ufone { --brand-color: #FF6600; --brand-bg: #f97316; }
        .brand-telenor { --brand-color: #00AEEF; --brand-bg: #0ea5e9; }
        .brand-onic { --brand-color: #6D28D9; --brand-bg: #8b5cf6; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Sim Data Configuration
        const SIM_DATA = [
            { 
                id: 'jazz', 
                name: 'Jazz', 
                color: 'border-red-600', 
                bg: 'bg-red-50', 
                text: 'text-red-700',
                shadow: 'shadow-red-200',
                logoUrl: 'https://upload.wikimedia.org/wikipedia/commons/9/92/Jazz_logo.png' 
            },
            { 
                id: 'zong', 
                name: 'Zong', 
                color: 'border-lime-500', 
                bg: 'bg-lime-50', 
                text: 'text-lime-700',
                shadow: 'shadow-lime-200',
                logoUrl: 'https://upload.wikimedia.org/wikipedia/commons/d/d8/Zong_4G_logo.svg' 
            },
            { 
                id: 'ufone', 
                name: 'Ufone', 
                color: 'border-orange-500', 
                bg: 'bg-orange-50', 
                text: 'text-orange-700',
                shadow: 'shadow-orange-200',
                logoUrl: 'https://upload.wikimedia.org/wikipedia/en/9/9d/Ufone_Logo.png' 
            },
            { 
                id: 'telenor', 
                name: 'Telenor', 
                color: 'border-sky-500', 
                bg: 'bg-sky-50', 
                text: 'text-sky-700',
                shadow: 'shadow-sky-200',
                logoUrl: 'https://upload.wikimedia.org/wikipedia/commons/5/53/Telenor_Logo.svg' 
            },
            { 
                id: 'onic', 
                name: 'ONIC', 
                color: 'border-purple-600', 
                bg: 'bg-purple-50', 
                text: 'text-purple-700',
                shadow: 'shadow-purple-200',
                logoUrl: 'https://play-lh.googleusercontent.com/F0fC4V9tYh9VzLCaXz8_bEwDrs0qH_uP9qM7Zz5W8kH9yX0g_Jc7v6j7z8x5c3v4b0=w240-h480-rw' 
                // Fallback for ONIC if image breaks, logic handled in component
            }
        ];

        // Default Tax Rate in Pakistan (approx 15% WHT on recharge)
        const DEFAULT_TAX_RATE = 15.0;

        const App = () => {
            const [selectedSim, setSelectedSim] = useState(SIM_DATA[0]);
            const [loadAmount, setLoadAmount] = useState('');
            const [packageCost, setPackageCost] = useState('');
            const [taxRate, setTaxRate] = useState(DEFAULT_TAX_RATE);
            const [isFullBalance, setIsFullBalance] = useState(false);
            
            // Calculation States
            const [usableBalance, setUsableBalance] = useState(0);
            const [status, setStatus] = useState('idle'); // idle, success, warning
            const [shortfall, setShortfall] = useState(0);
            const [requiredLoad, setRequiredLoad] = useState(0);

            useEffect(() => {
                calculate();
            }, [loadAmount, packageCost, taxRate, isFullBalance, selectedSim]);

            const calculate = () => {
                const load = parseFloat(loadAmount) || 0;
                const pkg = parseFloat(packageCost) || 0;
                
                // Calculate Usable Balance
                // Logic: Load Amount - (Load Amount * Tax%)
                let balance = 0;
                if (isFullBalance) {
                    balance = load;
                } else {
                    balance = load * (1 - (taxRate / 100));
                }
                
                setUsableBalance(balance);

                // Calculate Required Load for Package
                // Logic: If I need 100Rs balance, and tax is 15%, I need to load X where X * 0.85 = 100
                // X = 100 / 0.85
                let reqLoad = 0;
                if (isFullBalance) {
                    reqLoad = pkg;
                } else {
                    reqLoad = pkg / (1 - (taxRate / 100));
                }
                setRequiredLoad(Math.ceil(reqLoad));

                // Determine Status
                if (load === 0 && pkg === 0) {
                    setStatus('idle');
                    return;
                }

                if (pkg > 0) {
                    if (balance >= pkg) {
                        setStatus('success');
                        setShortfall(0);
                    } else {
                        setStatus('warning');
                        setShortfall(pkg - balance);
                    }
                } else {
                    setStatus('info');
                }
            };

            // Helper for image error handling
            const handleImageError = (e) => {
                e.target.style.display = 'none';
                e.target.nextSibling.style.display = 'flex'; // Show fallback text
            };

            return (
                <div className="min-h-screen flex flex-col items-center py-8 px-4 max-w-md mx-auto w-full">
                    
                    {/* Header */}
                    <header className="text-center mb-8">
                        <h1 className="text-3xl font-bold text-gray-800 mb-2">Sim Calculator</h1>
                        <p className="text-gray-500 text-sm">Check your recharge requirements instantly</p>
                    </header>

                    {/* SIM Selection Grid */}
                    <div className="grid grid-cols-5 gap-2 w-full mb-8">
                        {SIM_DATA.map((sim) => (
                            <button
                                key={sim.id}
                                onClick={() => setSelectedSim(sim)}
                                className={`sim-btn relative flex flex-col items-center justify-center p-2 rounded-xl bg-white border-2 transition-all duration-300 ${
                                    selectedSim.id === sim.id 
                                    ? `${sim.color} ${sim.shadow} shadow-lg scale-105 z-10` 
                                    : 'border-transparent shadow-sm opacity-70 hover:opacity-100'
                                }`}
                            >
                                <div className="w-10 h-10 md:w-12 md:h-12 relative flex items-center justify-center mb-1 overflow-hidden rounded-full bg-white">
                                    <img 
                                        src={sim.logoUrl} 
                                        alt={sim.name} 
                                        className="w-full h-full object-contain"
                                        onError={handleImageError}
                                    />
                                    <div className="hidden absolute inset-0 bg-gray-100 items-center justify-center font-bold text-xs text-gray-500">
                                        {sim.name[0]}
                                    </div>
                                </div>
                                <span className={`text-[10px] font-bold ${selectedSim.id === sim.id ? sim.text : 'text-gray-400'}`}>
                                    {sim.name}
                                </span>
                                {selectedSim.id === sim.id && (
                                    <div className={`absolute -bottom-1 w-1 h-1 rounded-full ${sim.bg.replace('bg-', 'bg-opacity-0 ')} bg-current`}></div>
                                )}
                            </button>
                        ))}
                    </div>

                    {/* Main Calculator Card */}
                    <div className="bg-white rounded-3xl shadow-xl w-full overflow-hidden">
                        
                        {/* Dynamic Header Line */}
                        <div className={`h-2 w-full ${selectedSim.bg.replace('50', '500')}`}></div>

                        <div className="p-6 space-y-6">
                            
                            {/* Inputs */}
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">
                                        Recharge Amount (Rs)
                                    </label>
                                    <div className="relative">
                                        <input
                                            type="number"
                                            value={loadAmount}
                                            onChange={(e) => setLoadAmount(e.target.value)}
                                            placeholder="e.g., 100"
                                            className="w-full text-2xl font-bold text-gray-800 border-b-2 border-gray-200 focus:border-gray-800 focus:outline-none py-2 bg-transparent transition-colors placeholder-gray-300"
                                        />
                                        <span className="absolute right-0 top-3 text-gray-400 text-sm font-medium">PKR</span>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1">
                                        Package Cost (Rs)
                                    </label>
                                    <div className="relative">
                                        <input
                                            type="number"
                                            value={packageCost}
                                            onChange={(e) => setPackageCost(e.target.value)}
                                            placeholder="e.g., 800"
                                            className="w-full text-2xl font-bold text-gray-800 border-b-2 border-gray-200 focus:border-gray-800 focus:outline-none py-2 bg-transparent transition-colors placeholder-gray-300"
                                        />
                                        <span className="absolute right-0 top-3 text-gray-400 text-sm font-medium">PKR</span>
                                    </div>
                                </div>
                            </div>

                            {/* Settings Toggle */}
                            <div className="flex items-center justify-between bg-gray-50 p-3 rounded-lg">
                                <div className="flex items-center gap-2">
                                    <div className="text-sm text-gray-600 font-medium">Full Balance Offer?</div>
                                    <div className="group relative flex justify-center">
                                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-gray-400 cursor-help"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                                         <span className="absolute bottom-6 scale-0 transition-all rounded bg-gray-800 p-2 text-xs text-white group-hover:scale-100 w-40 text-center z-50">
                                             Turn this on if you have a promo code or offer that gives 100% balance (0% tax).
                                         </span>
                                    </div>
                                </div>
                                <button 
                                    onClick={() => setIsFullBalance(!isFullBalance)}
                                    className={`w-12 h-6 rounded-full p-1 transition-colors duration-200 ease-in-out ${isFullBalance ? selectedSim.bg.replace('50', '500') : 'bg-gray-300'}`}
                                >
                                    <div className={`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-200 ease-in-out ${isFullBalance ? 'translate-x-6' : 'translate-x-0'}`}></div>
                                </button>
                            </div>

                            {/* Results Area */}
                            <div className={`rounded-2xl p-4 transition-all duration-500 ${
                                status === 'idle' ? 'bg-gray-50' :
                                status === 'success' ? 'bg-green-50 ring-1 ring-green-200' :
                                status === 'warning' ? 'bg-red-50 ring-1 ring-red-200' :
                                'bg-blue-50'
                            }`}>
                                <div className="flex justify-between items-end mb-2">
                                    <span className="text-sm text-gray-500 font-medium">Usable Balance</span>
                                    <span className="text-2xl font-bold text-gray-800">Rs. {Math.floor(usableBalance * 100) / 100}</span>
                                </div>

                                {status !== 'idle' && packageCost > 0 && (
                                    <div className="border-t border-gray-200/50 pt-3 mt-2">
                                        {status === 'success' ? (
                                            <div className="flex items-center gap-2 text-green-700">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                                                <span className="text-sm font-bold">Sufficient Balance</span>
                                            </div>
                                        ) : (
                                            <div className="space-y-2">
                                                <div className="flex items-center gap-2 text-red-600">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                                                    <span className="text-sm font-bold">Insufficient Balance</span>
                                                </div>
                                                <div className="text-xs text-red-500">
                                                    Short by Rs. {Math.ceil(shortfall)}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>

                            {/* Recommendation Card */}
                            {status === 'warning' && packageCost > 0 && (
                                <div className="bg-gray-900 text-white rounded-xl p-4 shadow-lg animate-pulse-slow">
                                    <div className="text-xs text-gray-400 uppercase tracking-wider mb-1">Recommended Recharge</div>
                                    <div className="flex justify-between items-center">
                                        <div className="text-sm text-gray-300">To get this package, load:</div>
                                        <div className="text-2xl font-bold text-white">Rs. {requiredLoad}</div>
                                    </div>
                                </div>
                            )}

                        </div>
                        
                        {/* Dynamic Footer in Card */}
                        <div className={`p-3 text-center text-[10px] text-white font-medium ${selectedSim.bg.replace('50', '500')}`}>
                           Current Tax Rate Applied: {isFullBalance ? '0%' : `${DEFAULT_TAX_RATE}%`}
                        </div>
                    </div>

                    <footer className="mt-8 text-center text-gray-400 text-xs">
                        <p>Â© 2025 PakSim Calc. Tax rates are estimates.</p>
                    </footer>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
